<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IntelligentDestiller: C:/workspace/Projeto/InteligentDestiller/src/AP_Web.cpp File Reference</title>
<link rel="icon" href="icon.png" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="icon.png"/></td>
  <td id="projectalign">
   <div id="projectname">IntelligentDestiller
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_a_p___web_8cpp.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">AP_Web.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Web Server functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="_a_p_8h_source.html">AP.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0be75b75b82f96e18d5c695059a67a63" id="r_a0be75b75b82f96e18d5c695059a67a63"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0be75b75b82f96e18d5c695059a67a63">handleWebSocketMessage</a> (void *arg, uint8_t *data, size_t len)</td></tr>
<tr class="memdesc:a0be75b75b82f96e18d5c695059a67a63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Variables and Constants for Web Server and WebSocket Server.  <br /></td></tr>
<tr class="separator:a0be75b75b82f96e18d5c695059a67a63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad296f25594d8ca4d02d0025819437b7b" id="r_ad296f25594d8ca4d02d0025819437b7b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad296f25594d8ca4d02d0025819437b7b">onEvent</a> (AsyncWebSocket *<a class="el" href="_o_s_8h.html#a56916c67f21f332014c1c19b200d45f3">server</a>, AsyncWebSocketClient *client, AwsEventType type, void *arg, uint8_t *data, size_t len)</td></tr>
<tr class="memdesc:ad296f25594d8ca4d02d0025819437b7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Web Server and WebSocket Server variables and constants initialization function.  <br /></td></tr>
<tr class="separator:ad296f25594d8ca4d02d0025819437b7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a553ce9cca044d40931e5cbe9deb407e4" id="r_a553ce9cca044d40931e5cbe9deb407e4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a553ce9cca044d40931e5cbe9deb407e4">setupRoutes</a> ()</td></tr>
<tr class="memdesc:a553ce9cca044d40931e5cbe9deb407e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup Calls.  <br /></td></tr>
<tr class="separator:a553ce9cca044d40931e5cbe9deb407e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Web Server functions. </p>
<dl class="section author"><dt>Author</dt><dd>SÃ©rgio Carmo</dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a0be75b75b82f96e18d5c695059a67a63" name="a0be75b75b82f96e18d5c695059a67a63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0be75b75b82f96e18d5c695059a67a63">&#9670;&#160;</a></span>handleWebSocketMessage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void handleWebSocketMessage </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>arg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Variables and Constants for Web Server and WebSocket Server. </p>
<p>Web Server and WebSocket Server variables</p>
<p>These variables are used to create the Web Server and WebSocket Server.</p>
<dl class="section note"><dt>Note</dt><dd>These variables are used to create the Web Server and WebSocket Server. </dd>
<dd>
These variables are used to handle the HTTP GET requests for various resources.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">server</td><td>Web Server </td></tr>
    <tr><td class="paramname">ws</td><td>WebSocket Server </td></tr>
    <tr><td class="paramname">processor</td><td>Web Server Processor </td></tr>
    <tr><td class="paramname">wsFrameInfo</td><td>WebSocket Frame Information </td></tr>
    <tr><td class="paramname">wsMask</td><td>WebSocket Mask</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<p>WebSocket Frame Information Structure Pointer (info)</p>
<p>Check if the WebSocket message is a text message and the final message in the frame sequence and the length of the message is equal to the length of the frame and the index of the frame is 0</p>
<p>Null-terminate the data to make it a string (char array)</p>
<p>Convert the data to a String object</p>
<p>Print the received WebSocket message</p>

</div>
</div>
<a id="ad296f25594d8ca4d02d0025819437b7b" name="ad296f25594d8ca4d02d0025819437b7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad296f25594d8ca4d02d0025819437b7b">&#9670;&#160;</a></span>onEvent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void onEvent </td>
          <td>(</td>
          <td class="paramtype">AsyncWebSocket *</td>          <td class="paramname"><span class="paramname"><em>server</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">AsyncWebSocketClient *</td>          <td class="paramname"><span class="paramname"><em>client</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">AwsEventType</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>arg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Web Server and WebSocket Server variables and constants initialization function. </p>
<p>This function initializes the Web Server and WebSocket Server variables and constants.</p>
<dl class="section note"><dt>Note</dt><dd>This function initializes the Web Server and WebSocket Server variables and constants.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">server</td><td></td></tr>
    <tr><td class="paramname">client</td><td></td></tr>
    <tr><td class="paramname">type</td><td></td></tr>
    <tr><td class="paramname">arg</td><td></td></tr>
    <tr><td class="paramname">data</td><td></td></tr>
    <tr><td class="paramname">len</td><td></td></tr>
  </table>
  </dd>
</dl>
<p>Handle WebSocket events based on the event type (type)</p>
<p>WebSocket client connected event</p>
<p>Print the IP address of the connected WebSocket client</p>
<p>WebSocket client disconnected event</p>
<p>Print the IP address of the disconnected WebSocket client</p>
<p>WebSocket data event</p>
<p>Handle the WebSocket message data event</p>
<p>WebSocket Pong event (response to a Ping)</p>
<p>WebSocket error event</p>

</div>
</div>
<a id="a553ce9cca044d40931e5cbe9deb407e4" name="a553ce9cca044d40931e5cbe9deb407e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a553ce9cca044d40931e5cbe9deb407e4">&#9670;&#160;</a></span>setupRoutes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setupRoutes </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup Calls. </p>
<p>Setup the routes for the web server.</p>
<p>This function defines the routes for handling HTTP GET requests for various resources such as HTML pages, CSS files, JS files, images, time adjustments, timer control, toggle actions, state actions, WiFi handlers, and timer handlers. </p>
<p>Set the WebSocket event handler function for the WebSocket Server (ws)</p>
<p>Add the WebSocket handler to the server (server) ///////////////////////////////////////////////////////////////////////////////////// Route for root / and index_webButtons.html</p>
<p>Send the index.html file to the client when the root / is requested</p>
<p>Send the index.html file to the client when the root / is requested</p>
<p>Route for CSS files</p>
<p>Send the style.css file to the client when requested</p>
<p>Send the style.css file to the client when requested</p>
<p>Send the style.css file to the client when requested</p>
<p>Route JS files</p>
<p>Send the script_actions.js file to the client when requested</p>
<p>Send the script_get_Data.js file to the client when requested</p>
<p>Send the script_timers.js file to the client when requested</p>
<p>Send the script_timers_Img.js file to the client when requested</p>
<p>Send the script_timers_2.js file to the client when requested</p>
<p>Route for image files</p>
<p>Send the icon.png file to the client when requested</p>
<p>Send the estg_logo.png file to the client when requested</p>
<p>Send the bg.png file to the client when requested</p>
<p>Send the destiller.png file to the client when requested</p>
<p>Send the BMB_ON.png file to the client when requested</p>
<p>Send the BMB_OFF.png file to the client when requested</p>
<p>Send the RAQ_ON.png file to the client when requested</p>
<p>Send the RAQ_OFF.png file to the client when requested</p>
<p>Send the Valve_ON.png file to the client when requested</p>
<p>Send the Valve_OFF.png file to the client when requested</p>
<p>Send the Auto_ON.png file to the client when requested</p>
<p>Send the Auto_OFF.png file to the client when requested</p>
<p>Send the Man_ON.png file to the client when requested</p>
<p>Send the Man_OFF.png file to the client when requested</p>
<p>Send the sMin.png file to the client when requested</p>
<p>Send the sMax.png file to the client when requested</p>
<p>Send the sAlarm.png file to the client when requested</p>
<p>Send the button_ON.png file to the client when requested</p>
<p>Send the button_OFF.png file to the client when requested</p>
<p>Routes for handling time adjustments</p>
<p>Send the response to the client when the /add1s route is requested</p>
<p>Send the response to the client when the /add5s route is requested</p>
<p>Send the response to the client when the /add10s route is requested</p>
<p>Send the response to the client when the /add1m route is requested</p>
<p>Send the response to the client when the /add5m route is requested</p>
<p>Send the response to the client when the /add10m route is requested</p>
<p>Send the response to the client when the /rem1s route is requested</p>
<p>Send the response to the client when the /rem5s route is requested</p>
<p>Send the response to the client when the /rem10s route is requested</p>
<p>Send the response to the client when the /rem1m route is requested</p>
<p>Send the response to the client when the /rem5m route is requested</p>
<p>Send the response to the client when the /rem10m route is requested</p>
<p>Routes for handling timer control</p>
<p>Send the response to the client when the /startTimer route is requested</p>
<p>Send the response to the client when the /stopTimer route is requested</p>
<p>Send the response to the client when the /resetTimer route is requested</p>
<p>Routes for handling toggle actions</p>
<p>Send the response to the client when the /toggleAutoMode route is requested</p>
<p>Send the response to the client when the /togglePump route is requested</p>
<p>Send the response to the client when the /toggleWaterOut route is requested</p>
<p>Send the response to the client when the /toggleWaterIn route is requested</p>
<p>Send the response to the client when the /toggleResistor route is requested</p>
<p>Routes for handling read actions</p>
<p>Send the response to the client when the /readAutoMode route is requested</p>
<p>Send the response to the client when the /readManualMode route is requested</p>
<p>Send the response to the client when the /readPump route is requested</p>
<p>Send the response to the client when the /readWaterOut route is requested</p>
<p>Send the response to the client when the /readResistor route is requested</p>
<p>Send the response to the client when the /readWaterIn route is requested</p>
<p>Send the response to the client when the /readWaterMax route is requested</p>
<p>Send the response to the client when the /readWaterMin route is requested</p>
<p>Send the response to the client when the /readWaterAlarm route is requested</p>
<p>Route for WiFi Handlers</p>
<p>Send the response to the client when the /readWifiQuality route is requested</p>
<p>Send the response to the client when the /readWifiSSID route is requested</p>
<p>Send the response to the client when the /readWifiTX route is requested</p>
<p>Send the response to the client when the /readWifiIP route is requested</p>
<p>Route for Timer Handlers</p>
<p>Send the response to the client when the /readTimer route is requested</p>
<p>Send the response to the client when the /readHour route is requested</p>
<p>Send the response to the client when the /readMinute route is requested</p>
<p>Send the response to the client when the /readSecound route is requested</p>
<p>Start Server</p>
<p>Start the server</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_6adfa92bb3e582fdc8de2d510418dea4.html">InteligentDestiller</a></li><li class="navelem"><a class="el" href="dir_1cba463c2b3133d6d2c8f13f1678c3ce.html">src</a></li><li class="navelem"><a class="el" href="_a_p___web_8cpp.html">AP_Web.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
